<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <script src="gof.js"></script>
</head>
<body>

<button onclick="test()">Run GOF</button>

<script>

  var gof = Module.cwrap("gof", "number", ["number", "number", "number"]);

  function callGof(cells){
    var input_array = new Int32Array(cells);
    var len = input_array.length;
    var bytes_per_element = input_array.BYTES_PER_ELEMENT;

    // alloc memory, in this case 5*4 bytes
    var input_ptr = Module._malloc(len * bytes_per_element);
    var output_ptr = Module._malloc(len * bytes_per_element);

    Module.HEAP32.set(input_array, input_ptr / bytes_per_element);
    const newSize = gof(input_ptr, output_ptr, len);
    var output_array = new Int32Array(Module.HEAP32.buffer, output_ptr, len);
    console.log('newSize', newSize);
    console.log("The starting array was:", input_array);
    console.log("The result read is:	", output_array);

    // dealloc memory
    Module._free(input_ptr);
    Module._free(output_ptr);
  }

  function test() {
    const arr = [1,2,3,4,5];

    callGof(arr);
  }

</script>


</body>
</html>
